#!/bin/bash

#############################################################################
# send_cmd_to_pdu_ex pduNo outlet cmd
#############################################################################
send_cmd_to_pdu_ex()
{
	(
		local pdu_on=1
		local pdu_off=2
		local pdu_reset=3

		local pdu_no=$1
		local outlet=$2
		local pdu_op=$3
		local pdu_ip=$(grep -P "^(PDU$pdu_no).*" $OPENLAB_CONF_DIR/$PDU_INFO_FILE | grep -Po "(?<=ip=)([^,]*)")
		local op=$(eval echo "\$pdu_$pdu_op")

		exec ap7921-control $pdu_ip $outlet $op
	)
}

#############################################################################
# pdu_power pduNo outlet op(on/off/reset)
#############################################################################
pdu_power()
{
	send_cmd_to_pdu_ex $@
}

#############################################################################
# pdu_on pduNo outlet
#############################################################################
pdu_on()
{
	pdu_power $@ on
}

#############################################################################
# pdu_off pduNo outlet
#############################################################################
pdu_off()
{
	pdu_power $@ off
}

#############################################################################
# pdu_reset pduNo outlet
#############################################################################
pdu_reset()
{
	pdu_power $@ reset
}

